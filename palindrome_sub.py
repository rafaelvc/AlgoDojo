# https://leetcode.com/problems/unique-length-3-palindromic-subsequences/submissions/

from functools import reduce 

class Solution:

    def countPalindromicSubsequence(self, s: str) -> int:
        if len(s) < 3:
            return 0
        i = 0
        j = len(s) - 1 
        letter_map = {}
        count = 0
        while j > 1:
            if s[j] not in letter_map: # necessary or leetcode timeouts
                if s[i] == s[j]:
                    # if not s[i] in letter_map:
                    #    letter_map[ s[i] ] = set()
                    letter_map[ s[i] ] = 1
                    temp_set = set()
                    for x in range(i+1, j):
                        # letter_map[ s[i] ].add( s[x] )
                        temp_set.add( s[x] )
                    # count += len( letter_map[ s[i] ] )
                    count += len(temp_set)
                elif j - i > 2:
                    i += 1
                    continue
            j -= 1
            i = 0
        return count
        # count = 0
        # for x, sets in letter_map.items():
        #     count += len(sets)
        # return count
        # return reduce( lambda x, kv: x + len(kv[1]), letter_map.items(), 0)

s = Solution()
print (s.countPalindromicSubsequence("abcbea"))
print (s.countPalindromicSubsequence("aba"))
print (s.countPalindromicSubsequence("aabca"))
print (s.countPalindromicSubsequence("adc"))
print (s.countPalindromicSubsequence("bbcbaba"))

z = "gywghdivwpgymbjqfbzelzsnmcezvvwimzvcdujeoexfaqmsphzsqwxtytjikvcddfzrmgqziiwqyfayezdzlkkffstwsxvqltxbiyplvvzypskmqdqsuscxvwgbbwargaveyiikkvscfvjmqduufoepeuegowaukvsjmkiozyoclterhrggszwyksguoyodfsrquhurhhjruuthiseqmqpgjbbfphxdkhkydtjgtyxxsuvlvakmqrbqrogpsgoesiyfdptupeynrvnswsagnnyijkdccklnkzkbyskemsivvyhwkvjswplfahkfoihucrdxzuqnofdbjpboqgzsqeseyibmkulvxrwfoojkhraayrmiwpkjvjaccjxbefrfskpmlqxhaqgedqguytmawjzekztquxvwjakyhjjnfkmdohpfydsnztswnnckryxsnhifirtlywtluzqaqmgdawrvwbqhuxlpfxmovbgjcjptwevolhbchzgrwxnmojuiypvdcqltabohaswrfuryiuphxrveyndwzmvhlglxttlikrchkqscknpjwixdnhoiqhtecdceyynsuouhbcduqvmscimlzwhdubteisewmaztbenultkhieimykwqvrklqxaueldtgdyqznkrfzthfljxoorrysispbdhaylfrroxxqhrrhzpglcgmpkqvlxuwgnaraqpnkmudgiiadeedokauinfzexfmfggxwwnoyrgoqhyerfydnslwkpocncnfyxgfyssreuijhleabgnprqmggxrpwffgwjbfzvwdbxzbrvugqlglrmjnplmcttmggznmzzenytxhriphvjcpmtndrbpkhaopegdllwsxlbmsvaciislwmjbkswgppnzumdkqnvsbaehtwfraxofdnudiirzfqbvnwathcxlfdsjsuhxqztcqmjwofsqdvnqdnwsoofpqkayvoxxtowpxtommjpnkwgvpdjbirlzixftztndnefdqmzumxjciymyzxdbdghsjwokljpdlcoskjshksqlxtpugrnlqncstkedcmtkagvaxobuamsozdvvekmgpmtfeitcfqdmwqwgsshhmenmpehlrrxbikkkopgwrjflzwejvdzpxyxonuopezecekixsojmaykeivcfidznhfruexgscexdbgbzonqdmqrlumffcetbpwmcmxrygctcpjowzovbdnzztjuixgjkhrqxwsbwbmwoszqewxmssbxigsdetyeghuvyqgaooiumlgjrnoyicfalkmxasvylmdqsmhakhrjgrecyjirinobqovnvsadvgjbruwzqeqytjgzmrugismpceybzovifqtgrzceinspjivfmpmoncsnbkcoyxohhmucqzthlxymknqiisriuwhygemjcysijmbcqvzektocbjlvdbikvkthskkrqofemivfnsfrggewnyrnyqtyuligpxtaadncbfekkconnkgsxpbzdmmkawphtjtevojffipxzbpwtxjhpufavbtwbltxiafzxgdtaowfyyfwwfpjcmbatqlcchtkjroxesrwydnavhqvzfjxrzbbpuvgrsjixijycojomizwzjrogdyaatnralgtlwybycwakmmdbbhlhjysynveqyquhccjwmpdfwqtvmajrqdgtzzteoxrrimjdhmbnsrldwwjfevhoevtedbwfnlxrdywbxkljuanuztxciefmvvdyhhfjbovpuvbpkasywkhnjnheemkjisvxidemapdjsvihwtelbyjeuzplreaxfiwlfebpnsfdfbmqftfhmmlbuyinnluzhvuwxpbrwofagmnincgusqqdowfnkqlakcsyjubyuqdnupjcjnamtldlacekfdtewekjwbcqzkagidkodybvhlpadgmcysudyjvdevufhptqisyfzcdytqhzfvunkxlabnnwjrhhqcczdhlypmgcjwaislwgxcorrqhkrehiygqoamdavtwsjzhnbdlmjaczllmilesvghxdualhdtatoafhfscrnelsihvlgfgwdinnzvqtxexwwfayeygkpfnmcyxiwwssdecrqesbtadrhzzeroqojtfvudisgfjoqewnsxqpmsisvsxhiispmewpwefnorcykghuvpcgcnhultrgobrrwylqzkcezmqqhpajfcngjeofrivcsdsxvpzmaolzvrleoofuhcjuvptfpjepuqfmfiqebyctsrnlgvulzvxfabccqgcodtmycsmbcforgvjhppwphxpqrddmecdxihceerwwnqxqactirfcodaqpekvdwdqgrouqxkwcinallbyutjrpzirvkdqewonvnmyrnuhtnybedhjjxfmsddiksujcvzunbicveqhtxnztblkgohgunxjsdunotlunithlifffkbpodtgoytzqswuhdzyekftafcblnolyurbviiikrtffsrcxdrdewxzebmtzoeaqlytmbtefuvoyfmmtpcpprdeagltimgaoiyyspczzpofzptqodlfgaaryovxttvfsbsbmkpxxkxsnnqasphxuxpegtmnswsnpqdbuzourxmfsdxwxmzlgaqtgayfthdghgtcmigtbfdrebblbwaqtlpvygicrwzhjirfbjevhxymuuvxpcmlnsoksaepjsqbczibasdxqfkcmovidxxvnzixyvhojbhqtrctagutmvxvovidfetwhgriqwrbftadvidiwaeicvumbnwvfnkaccfvfspctsovvrlhkhgzbvfwrvsocdrzgawddynatuhbowggygbvvwsjwjkowbedqaestyrosljfeuhiorwpgcecgspnfallbrkbtoufcyuipofcjqgqmyfmivyocergaxraifvioniqeoygznmzmsswxjqyavuichdnnbsyswmqymqpvtfrvajczjqagjstghghcxondkmhgmycgydazbcrapbqaizmuewxghthyihgtxzxanxonnckglcxrnumuvxdjjhnlnktqxvlbyenttmigwdzhejoqgobgsdnnqssvtugrnefqvxbormcwxuybfwhadbhkgjlugbwijvreqdgwqmlcotxodrywqljnjcgpnvezhrhkwptdjmwzmrfhujymehgmqbznuguxykdbejizhghfkfycagbxnlhafvpgyrrhupffswwecidudkvyovxytbfbckfudtluljhbgmetixzlupypsdkuhorbkbzpyesqvowmmfqwfecyottdqwnliryjrvqfhxnuaqlrlrwegquyqkketzyoowoowgultllqkwdgauljgqhsygnbbidodvxmamwxrsnkxekblbeqdxaezrhkcsimvokzwjmbxonfofzsgqsekpltojlwefiogbrxlsyhetdgwrupksvxcpyskbgssbyxomjrbeaxrlufegidpczzrkqctxegvvpcwokgescuisokwyapwknqmrmbssscswkhvnyyphbrvapsoodumbhbccrgopwknnnoapduumuizombssqftyzpqboxtufyaaxgyfqxssqpihuvtyvyazwokoexefonqhecxlhmwmeisgiklechdslygmskchfqfatxnhwefboxvgfujsawrcuibzytdpfpdtfmgisfzkaehadluidjdlrdtijqgjwqenfshyvujkxcnbzkvjiuwcspicwivmoilcgcyddnvbhworqgqivhjuigninvyqsbohponoppqvwhhabupyojhiqcooaxummbyncfepfyumbdmdghsdvlqudfgsnouuurhcehddvcvviqixtartsarknwmgmrvmaqqysquaembbqyuahaelilsqwxtfbivcpgceznllihxzvufgtdoncnjcppprmzatjymzusmvxdumuczuhiavtguqqvlqhslvfdmgwseecfhaknrqkjpxxgjyskjnjxxtchftrbtobikclmbtbdcdriebkghaslhxxzaxufvqmnmmjsumsxeuegmireomkxudtdzevpwolovrvnpsasdwjzshalveinkynawhbyjkfwsutxbeicunsnwhtakpzxxdgjmajgofmpyryiwjyeziooksjpjhwibhicuakjkjnpoqfqqczqgejmecokzveorsnwgnkjlrrcsoyyxzroejcuiofjtwhphsfgqlyouvulzbtykqxxpjrjnwkttbyeyjcwtmahoalmsdzmavxlupkjudmwqipsnfoovvraknchmozyvsufwillyzqnileazqwuwkpcsuhpfupkmsjxhwcucyjfblzoqlqicmkfuvbbdpxvwlkyyeuunvzfvexzfouefpytxbmrlkdjkchsuaevoyttgjcuharjaqrjeifaimqwnuqdwwzakusqmlqhdbnyfhdszymxbmhskzqarsrdmkdymdbkifwupotrskkorvkketdzvowrdgasaojgomfhosktzoglatowyihczvjwczkcezpejcrwmjbfukwnaodrrwibcfnfrphqcrmewpghuayjbjmctlkwmehekiagwibyouppsegewgwatlxciqsdwmkrvkotojwrdfuusejtucenakvlnnxffnhwdgxxrjbfjtpiasumropsstyptvbxvsdczmelbmkremdscukcnafetzphfdpnvgbivzrsnebvcpdomellfythwnrnapayvtqhswtpmudgzpzenwyfwlqgrisujhefgbjonjibnpqccanlngivuwphvsoldvgwziytotunjdmcvcwrdlcpougzktfksuwvirkqsabhhdrhoetjybuqcquywhzewvxdfjxqhzxranjiroehfryszxzcebskpxfghojdqourmvmebfomdnrdvtslkyjfpznafglphjgvakyphieepaqobqvmceoeaesvzqixefldtbvbcwytytzlhbkioujxnihmmjgduhlhkezikyfykvxaveiwscqrzcwenbasbecaxngzqkbidzfpltslynsfukwhnpgvzwffafaljkwgzegqbddnqchtcdibrnnthhjvqlmqtgrfyscgywjgtdrwhtkaphxuayxqjpjcccujvhbyzuiagohhwxtxvyjlwbgaztieahqjmeshadcdepfeayhwcprmsmhrglfslicftnmpnwjtwjyiigiqqiichkbgmxgznokawqyhtjvrorpgmsobijaowfihhaisqzpimwxmsxpjwoxbcnhzejgmbxexigfojfawdghobqyqkkehpakwxfpkwjilesbjqezufpqubebbdrzfmeszoxytuounwroyxskklrhffcipfxbedhtcxbhzfjqpgrnhpvwejncxurjhkwaefecsdrywbcfjrjbcovymrjwhkkhfmtagtcabqewxqfipgynjkddifltyaulzkkxmyehobbtvaagauuljayzdrjtohcdnnemtzmuzdzqbthwooyclcbkztrntoqqjgnvlpcjxipgtfbxmfxehepjebpqghhvwuhgglidcayjvszqcwpynelzokarzggjbrieigrhlfmocvvzqvhbmbccefjysrztwdytgqaksgnklcvtbkzxjqyudogbfbcwhmvwerpzrhfckuchhvoaiwaifturpuazmqsspwqpultsfcwawyltixsydwbwlboxlvoitoazzvdnmhbwixycjanpicocjuwznfnbudgxwllcyohdcuftzropujqmzvqpjacohbdtwyenlypybnxskvhowwtkxyduozjlewsojelldzlmzwqjpfalrmgzvxytnakvonwybyrmpdstxylyylquahxdesyoeflxuaowmwietrzhcydovcxzmwvaesvrgmuncwwybuexcvuqwythawoyqrpvkjopmnrukloeeukzeihhmyztuhkvoxhbzlcdiclacuhwcocklecpvpxetcomtejbiuxdgejxhruwshyvtsmtutxdmfnomlbgdfhhjbqrrfswbdchmocgljidpmevwhmwfghbrhrdvilvcshuhnyovggquxsjixfmvbctbfjyjpsqpikjhrmklgochnkpzshaeuelstfdrshqdkahniqvintyejtkbpcxmjqoaizfgabjzpbyfixjflhdsxesrbriiyzcuscioovtoegpllixfvdcqtfordjnkwgvsdpvriiwowcyhzoyjdgadfvxjwjqpyffcduvbswigrjkvcfsjeipygtavhssasophyjqlbmnxwegyglqblcaarkniingltxwjdxrtmaimfspmdgrnkukkfxfpkengoliarehwjvtxfgxzntduxdjkttjherhlxjofinyqpewhdxuknfppfvyqaswfsfcdhxtrmjgjssaedqykxkpmvwycqpkixnzdmospydtgvfhrmpdnhitdguaefrucqjwdrggtyzqnajpceoyodcvzxtqiljlsfiwfualsfldrjjncyayzznuzyqlzrcuzrlegdajoevjbxzquzujwppmajpojvxvdvisnxyvwpenrrkgqrrlvlffabcztzjvuepjvkkbjlwmutfhmgakgwlsdqldlygzizbqkoenqkdehkawctwyoulvjmphtogazamlyzbzmzqrfhkcviivgadlvsbjbfanqfjctqirvjdxzfiuvokryuxwmyjvawwjabiwshjcfohvtrsbqhxzxvicedhcxjeqcgghoydtowkofyegfzqquokskxpikqhbpfcjopiczgtwvzupqaqoiwngqbuvgmwczikirqrdkvznlvzabxopcqfncblnqhugwfzrjmcvsoubwahsrdjtqdkjhlrwwazonzmktcgxeejylpsevhghossmdkysbrpblmgcuvivuzixfioczrqobagvwmflqvyncnncytlwtartxxnqrzbdflmpzmgvxpjxyueqftmdojdekvzxlprkqrmgnwqgkirhvqqyknoyzpwzbcvteahdmifynjgjaieaurtqzcycsstthcbbfpgvludtburawtavtkytsrcmnnavhymgzoswdjpuxyfqxnylbtsbjotosrjlmveclsyikmnmrlgstmwzugqigcfrossfocaarywwzqkciyqpraoyymjxaxjablrybjnbjnfdslflkcjrooowyvhskbihtrswzxzrdbveeuuquflarbgeynlusyftmltrqhcowjaduphamghczyynxgiexviyqgdnzxgxttdwnlcfeqaluqfcrsmyswksqntdfwseybdcpyorbmoxfpveupqpyvvaatxdorrnddgtxqzneowjsaznumypnlooehgefiosqjnasueuadbmjzuyyqoocmoowfkqpcxktjrscbghwxzikowetxegrbrbmzwjuyhrkngpnpyjdmjcwyefqxxkjjijetuzarhluhnznsrsbchlikylflsaanryyqblzstmhlyfhasliiasrffzuwztzmdrsqkfnnggtkdrdtvzdfexbsuwqimrhdavdtcnknmktbuohlsscxvrdcjxtcfchentmshugglcuuknfzmgmicvzllytpfwqpabglnrsihuefgrlryhcviynkfhdjtxagxliigzhvhbayropnikarkkrklfptmnykswsxppsotyyqvmxozysnwctkdatcirssgkhgirfseyxijqmnnrnovavjimeanodhzrwchesfnnugsweheohatopkmnxgmvcyadviooyiaxdmaexrgvwmwakiqkzdvowibqeuwarsddwgupfqvajrmhpkatjzjcxnehfsetjcdewezvfpryoyvxhegadsuvcwbtpwirzapnhrewyouywqvsqhsqoyuwmgrprwtchxtvrzchyayhzvnvkrjdqqqeemljqrzpdzsdtqjksqctlvxdvyquscazlifqeupulfklomoldeybrxvdshgdtlkzribilqeugctkhvtosohmarlplcmpeocvfyjehfpdpnqfbsxynrbjgpaegiultvcvtsuuygwtzqhwzoxdrphjyctfvuxohxhhdvgqorxzhlzxpxtahwviouhlqjhwfoerbzzsoeccwnshezzlxjxjfqwayhrfiwbjvarqvtsowgkslfqzrfrqvjmlsrdvlvkkimikgjncdbokopqzhpkeifpexcksfmulqbtfgtbbmnljrjhzaiorzltrjisoxbrcvjowjzrjlklvfjwrwdukdcqqcfkyzkgpjrvyxmmeufjlbgskstyqkaekyrzvgxsvilggzlhsecuqapxxmuzgntmaqtjtzafgzrnipfrborhqyjtcbfyvpwnfstybhgybkqrfafhjokqtvauunxiqxzrnsjsgsbhpnbfptlrihwgguotuawlvqyppdbhjrqehtkffjdxkvqlwzgtfwvkqktibsxuiashdwdeskdgvgycuazmqvfnannldrnazjirwgdvmqsmaypbomgqivthyyxkryjqvfkkyascgebefkenlzbcpbiftzbdsinadxovxqrnofevwuqmjlfurgjymykdfztfaxyuhlzgraneragtijegqomgcpgojhuvpstpgwnvvxasjsforsojjtyuywsebnpkzhvnqxhftunzxjykguqyrmbuuyquoirsgupjegcoogocnfubnmtkpgjohcimgrxrtzusakfdxvkyayitryokwioklfvaxwcreiljhpywhgsojpkfetyuxvpbdfcjkzfrnhsgyuehstxytscdoxptzynbgxlmdfrqfbudtmtwcnooorhusgvlsbnxiottmqfqbyuuuoeapjgqnkmilfnkniiqtvrvzzfxmeekhbcqioztdndmjpodiznvghntoluazdxlaojzltdzquwjdhluvysxlygxwykmxlbbvoxyjsjujxwydisorlzmuvryjyqqrsmvcouxncounxdpmgnmomikvecyvgmuutbrxnuabxxxyzwyhwpbulhfunlqdgsxmzzkajksxeqkpxkbczhwgnmfdpkdncadknijbtyelmxhnnsxhrxpmcfoudtoetqsvicfnbxhhuihiehcfzqvawshpdramcvlomjfjahuizipdwfffxwrwfdiomyeexibqqgpybpuzsngiydmaxjnupalgbzmokmvlfmpgbixqqcxhhmhaatruihatgiqzlakajbucuzqjlocmtapnmlrbrdthytkfgqnngvvzblwwokuursysmcrole"
print (s.countPalindromicSubsequence(z))


